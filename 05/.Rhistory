data_height_2 <- data_height
data_height_2$height <- log(data$height)
heigth_reg <- quap(
alist(
height ~ dnorm( log(b0 + b1*weight), sigma ),
b0 ~ dnorm(60, 50) ,
b1 ~ dnorm( 0 , 1),
sigma ~ dunif( 0 , 50)
) , data=data_height_2)
reg_precis <- precis(heigth_reg, prob=0.95)
reg_precis
post <- extract.samples(heigth_reg, n=1e4)
weight_seq <- seq(from=3, to=48, by=0.5)
mu_link <- function(weight) post$b0 + post$b1*weight
mu <- sapply(weight_seq, mu_link)
mu_mean <- apply(mu, 2, mean)
mu_hdpi <- apply(mu, 2, HPDI, prob=0.95)
height_weight <- function(weight){
rnorm(n=nrow(post), mean = post$b0 + post$b1*weight, sd=post$sigma)
}
sim_height <- sapply(weight_seq, height_weight)
height_hpdi <- apply(sim_height, 2, HPDI, prob=0.95)
plot(height~ weight, data=data_height, col=col.alpha(rangi2, 0.9))
lines(weight_seq, mu_mean)
shade(mu_hdpi, weight_seq)
shade(height_hpdi, weight_seq)
reg_precis <- precis(heigth_reg, prob=0.95)
reg_precis
data_height_2 <- data_height
data_height_2$height <- log(data$height)
heigth_reg <- quap(
alist(
height ~ dnorm( log(b0 + b1*weight), sigma ),
b0 ~ dnorm(log(60), 50) ,
b1 ~ dnorm( 0 , 1),
sigma ~ dunif( 0 , 50)
) , data=data_height_2)
reg_precis <- precis(heigth_reg, prob=0.95)
reg_precis
post <- extract.samples(heigth_reg, n=1e4)
weight_seq <- seq(from=3, to=48, by=0.5)
mu_link <- function(weight) post$b0 + post$b1*weight
mu <- sapply(weight_seq, mu_link)
mu_mean <- apply(mu, 2, mean)
mu_hdpi <- apply(mu, 2, HPDI, prob=0.95)
height_weight <- function(weight){
rnorm(n=nrow(post), mean = post$b0 + post$b1*weight, sd=post$sigma)
}
sim_height <- sapply(weight_seq, height_weight)
height_hpdi <- apply(sim_height, 2, HPDI, prob=0.95)
plot(height~ weight, data=data_height, col=col.alpha(rangi2, 0.9))
lines(weight_seq, mu_mean)
shade(mu_hdpi, weight_seq)
shade(height_hpdi, weight_seq)
# plot(height~ weight, data=data_height, col=col.alpha(rangi2, 0.9))
lines(weight_seq, mu_mean)
# plot(height~ weight, data=data_height, col=col.alpha(rangi2, 0.9))
plot(weight_seq, mu_mean)
shade(mu_hdpi, weight_seq)
shade(height_hpdi, weight_seq)
data_height_2 <- data_height
data_height_2$height <- log(data$height)
heigth_reg <- quap(
alist(
height ~ dnorm( log(b0 + b1*weight), sigma ),
b0 ~ dnorm(60, 50) ,
b1 ~ dnorm( 0 , 1),
sigma ~ dunif( 0 , 50)
) , data=data_height_2)
reg_precis <- precis(heigth_reg, prob=0.95)
reg_precis
data_height_2 <- data_height
data_height_2$height <- log(data$height)
heigth_reg <- quap(
alist(
height ~ dnorm( log(b0 + b1*weight), sigma ),
b0 ~ dnorm(60, 50) ,
b1 ~ dnorm( 0 , 1),
sigma ~ dunif( 0 , 50)
) , data=data_height_2)
reg_precis <- precis(heigth_reg, prob=0.95)
reg_precis
post <- extract.samples(heigth_reg, n=1e4)
weight_seq <- seq(from=3, to=48, by=0.5)
mu_link <- function(weight) log(post$b0 + post$b1*weight)
mu <- sapply(weight_seq, mu_link)
mu_mean <- apply(mu, 2, mean)
mu_hdpi <- apply(mu, 2, HPDI, prob=0.95)
height_weight <- function(weight){
rnorm(n=nrow(post), mean = post$b0 + post$b1*weight, sd=post$sigma)
}
sim_height <- sapply(weight_seq, height_weight)
height_hpdi <- apply(sim_height, 2, HPDI, prob=0.95)
# plot(height~ weight, data=data_height, col=col.alpha(rangi2, 0.9))
lines(weight_seq, mu_mean)
plot(height~ weight, data=data_height, col=col.alpha(rangi2, 0.9))
lines(weight_seq, mu_mean)
shade(mu_hdpi, weight_seq)
shade(height_hpdi, weight_seq)
weight_seq <- seq(from=3, to=48, by=0.5)
mu_link <- function(weight) log(post$b0 + post$b1*weight)
mu <- sapply(weight_seq, mu_link)
mu_mean <- apply(mu, 2, mean)
mu_hdpi <- apply(mu, 2, HPDI, prob=0.95)
height_weight <- function(weight){
rnorm(n=nrow(post), mean = log(post$b0 + post$b1*weight), sd=post$sigma)
}
sim_height <- sapply(weight_seq, height_weight)
height_hpdi <- apply(sim_height, 2, HPDI, prob=0.95)
plot(height~ weight, data=data_height, col=col.alpha(rangi2, 0.9))
lines(weight_seq, mu_mean)
shade(mu_hdpi, weight_seq)
shade(height_hpdi, weight_seq)
data_height <- read.csv("table_height.csv")
head(data_height)
# data_height_2 <- data_height
# data_height_2$height <- log(data$height)
heigth_reg <- quap(
alist(
height ~ dnorm( b0 + b1*log(weight), sigma ),
b0 ~ dnorm(60, 50) ,
b1 ~ dnorm( 0 , 1),
sigma ~ dunif( 0 , 50)
) , data=data_height_2)
reg_precis <- precis(heigth_reg, prob=0.95)
reg_precis
# data_height_2 <- data_height
# data_height_2$height <- log(data$height)
heigth_reg <- quap(
alist(
height ~ dnorm( b0 + b1*log(weight), sigma ),
b0 ~ dnorm(60, 50) ,
b1 ~ dnorm( 0 , 1),
sigma ~ dunif( 0 , 50)
) , data=data_height)
reg_precis <- precis(heigth_reg, prob=0.95)
reg_precis
post <- extract.samples(heigth_reg, n=1e4)
weight_seq <- seq(from=3, to=48, by=0.5)
mu_link <- function(weight) post$b0 + post$b1*log(weight)
mu <- sapply(weight_seq, mu_link)
mu_mean <- apply(mu, 2, mean)
mu_hdpi <- apply(mu, 2, HPDI, prob=0.95)
height_weight <- function(weight){
rnorm(n=nrow(post), mean = post$b0 + post$b1*log(weight), sd=post$sigma)
}
sim_height <- sapply(weight_seq, height_weight)
height_hpdi <- apply(sim_height, 2, HPDI, prob=0.95)
plot(height~ weight, data=data_height, col=col.alpha(rangi2, 0.9))
lines(weight_seq, mu_mean)
shade(mu_hdpi, weight_seq)
shade(height_hpdi, weight_seq)
# data_height_2 <- data_height
# data_height_2$height <- log(data$height)
heigth_reg <- quap(
alist(
height ~ dnorm( b0 + b1*weight, sigma ),
b0 ~ dnorm(60, 50) ,
b1 ~ dnorm( 0 , 1),
sigma ~ dunif( 0 , 50)
) , data=data_height)
reg_precis <- precis(heigth_reg, prob=0.95)
reg_precis
post <- extract.samples(heigth_reg, n=1e4)
weight_seq <- seq(from=3, to=48, by=0.5)
mu_link <- function(weight) post$b0 + post$b1*weight
mu <- sapply(weight_seq, mu_link)
mu_mean <- apply(mu, 2, mean)
mu_hdpi <- apply(mu, 2, HPDI, prob=0.95)
height_weight <- function(weight){
rnorm(n=nrow(post), mean = post$b0 + post$b1*weight, sd=post$sigma)
}
sim_height <- sapply(weight_seq, height_weight)
height_hpdi <- apply(sim_height, 2, HPDI, prob=0.95)
plot(height~ weight, data=data_height, col=col.alpha(rangi2, 0.9))
lines(weight_seq, mu_mean)
shade(mu_hdpi, weight_seq)
shade(height_hpdi, weight_seq)
post
head(post)
precis(heigth_reg, prob=0.95)
lm(height ~ weight, data = data_height)
summaray(lm(height ~ weight, data = data_height))
summary(lm(height ~ weight, data = data_height))
plot(height~ weight, data=data_height, col=col.alpha(rangi2, 0.9))
lines(weight_seq, mu_mean)
shade(mu_hdpi, weight_seq)
shade(height_hpdi, weight_seq)
data_height_2 <- data_height
data_height_2$height <- log(data_height_2$height)
heigth_reg <- quap(
alist(
height ~ dnorm( log(b0 + b1*weight), sigma ),
b0 ~ dnorm(60, 50) ,
b1 ~ dnorm( 0 , 1),
sigma ~ dunif( 0 , 50)
) , data=data_height_2)
head(data_height)
head(data_height_2)
precis(heigth_reg, prob=0.95)
summary(lm(height ~ weight, data = data_height))
summary(lm(height ~ weight, data = data_height_2))
data_height_2 <- data_height
data_height_2$height <- log(data_height_2$height)
heigth_reg_log <- quap(
alist(
height ~ dnorm( log(b0 + b1*weight), sigma ),
b0 ~ dnorm(60, 50) ,
b1 ~ dnorm( 0 , 1),
sigma ~ dunif( 0 , 50)
) , data=data_height_2)
data_height_2 <- data_height
data_height_2$height <- log(data_height_2$height)
heigth_reg_log <- quap(
alist(
height ~ dnorm( log(b0 + b1*weight), sigma ),
b0 ~ dnorm(60, 50) ,
b1 ~ dnorm( 0 , 1),
sigma ~ dunif( 0 , 50)
) , data=data_height_2)
precis(heigth_reg_log, prob=0.95)
data_height_2 <- data_height
data_height_2$height <- log(data_height_2$height)
heigth_reg_log <- quap(
alist(
height ~ dnorm( log(b0 + b1*weight), sigma ),
b0 ~ dnorm(60, 50) ,
b1 ~ dlnorm( 0 , 1),
sigma ~ dunif( 0 , 50)
) , data=data_height_2)
precis(heigth_reg_log, prob=0.95)
precis(heigth_reg_log, prob=0.95)
data_height_2 <- data_height
data_height_2$height <- log(data_height_2$height)
heigth_reg_log <- quap(
alist(
height ~ dnorm( log(b0 + b1*weight), sigma ),
b0 ~ dnorm(60, 50) ,
b1 ~ dnorm( 0 , 1),
sigma ~ dunif( 0 , 50)
) , data=data_height_2)
precis(heigth_reg_log, prob=0.95)
post <- extract.samples(heigth_reg_log, n=1e4)
weight_seq <- seq(from=3, to=48, by=0.5)
mu_link <- function(weight) log(post$b0 + post$b1*weight)
mu <- sapply(weight_seq, mu_link)
mu_mean <- apply(mu, 2, mean)
mu_hdpi <- apply(mu, 2, HPDI, prob=0.95)
height_weight <- function(weight){
rnorm(n=nrow(post), mean = log(post$b0 + post$b1*weight), sd=post$sigma)
}
sim_height <- sapply(weight_seq, height_weight)
height_hpdi <- apply(sim_height, 2, HPDI, prob=0.95)
plot(height~ weight, data=data_height, col=col.alpha(rangi2, 0.9))
lines(weight_seq, mu_mean)
shade(mu_hdpi, weight_seq)
shade(height_hpdi, weight_seq)
weight_seq <- seq(from=3, to=48, by=0.5)
mu_link <- function(weight) log(post$b0 + post$b1*weight)
mu <- sapply(weight_seq, mu_link)
mu_mean <- apply(mu, 2, mean)
post <- extract.samples(heigth_reg_log, n=1e4)
weight_seq <- seq(from=3, to=48, by=0.5)
mu_link <- function(weight) log(post$b0 + post$b1*weight)
mu <- sapply(weight_seq, mu_link)
mu_mean <- apply(mu, 2, mean)
mu_hdpi <- apply(mu, 2, HPDI, prob=0.95)
height_weight <- function(weight){
rnorm(n=nrow(post), mean = log(post$b0 + post$b1*weight), sd=post$sigma)
}
sim_height <- sapply(weight_seq, height_weight)
height_hpdi <- apply(sim_height, 2, HPDI, prob=0.95)
plot(height~ weight, data=data_height, col=col.alpha(rangi2, 0.9))
lines(weight_seq, mu_mean)
shade(mu_hdpi, weight_seq)
shade(height_hpdi, weight_seq)
plot(height~ weight, data=data_height_2, col=col.alpha(rangi2, 0.9))
lines(weight_seq, mu_mean)
shade(mu_hdpi, weight_seq)
shade(height_hpdi, weight_seq)
data_height_2 <- data_height
data_height_2$weight<- log(data_height_2$weight)
heigth_reg_log <- quap(
alist(
height ~ dnorm( b0 + b1*log(weight), sigma ),
b0 ~ dnorm(60, 50) ,
b1 ~ dnorm( 0 , 1),
sigma ~ dunif( 0 , 50)
) , data=data_height_2)
precis(heigth_reg_log, prob=0.95)
data_height_2 <- data_height
data_height_2$weight<- log(data_height_2$weight)
heigth_reg_log <- quap(
alist(
height ~ dnorm( b0 + b1*log(weight), sigma ),
b0 ~ dnorm(60, 50) ,
b1 ~ dnorm( 0 , 1),
sigma ~ dunif( 0 , 50)
) , data=data_height_2)
head(data_height_2)
head(data_height)
precis(heigth_reg_log, prob=0.95)
weight_seq <- seq(from=3, to=48, by=0.5)
mu_link <- function(weight) post$b0 + post$b1*log(weight)
mu <- sapply(weight_seq, mu_link)
mu_mean <- apply(mu, 2, mean)
height_weight <- function(weight){
rnorm(n=nrow(post), mean = post$b0 + post$b1*log(weight), sd=post$sigma)
}
sim_height <- sapply(weight_seq, height_weight)
height_hpdi <- apply(sim_height, 2, HPDI, prob=0.95)
post <- extract.samples(heigth_reg_log, n=1e4)
weight_seq <- seq(from=3, to=48, by=0.5)
mu_link <- function(weight) post$b0 + post$b1*log(weight)
mu <- sapply(weight_seq, mu_link)
mu_mean <- apply(mu, 2, mean)
mu_hdpi <- apply(mu, 2, HPDI, prob=0.95)
height_weight <- function(weight){
rnorm(n=nrow(post), mean = post$b0 + post$b1*log(weight), sd=post$sigma)
}
sim_height <- sapply(weight_seq, height_weight)
height_hpdi <- apply(sim_height, 2, HPDI, prob=0.95)
plot(height~ weight, data=data_height_2, col=col.alpha(rangi2, 0.9))
lines(weight_seq, mu_mean)
shade(mu_hdpi, weight_seq)
shade(height_hpdi, weight_seq)
weight_seq <- seq(from=0, to=5, by=0.1)
mu_link <- function(weight) post$b0 + post$b1*log(weight)
mu <- sapply(weight_seq, mu_link)
mu_mean <- apply(mu, 2, mean)
mu_hdpi <- apply(mu, 2, HPDI, prob=0.95)
height_weight <- function(weight){
rnorm(n=nrow(post), mean = post$b0 + post$b1*log(weight), sd=post$sigma)
}
sim_height <- sapply(weight_seq, height_weight)
height_hpdi <- apply(sim_height, 2, HPDI, prob=0.95)
plot(height~ weight, data=data_height_2, col=col.alpha(rangi2, 0.9))
lines(weight_seq, mu_mean)
shade(mu_hdpi, weight_seq)
shade(height_hpdi, weight_seq)
post <- extract.samples(heigth_reg_log, n=1e4)
weight_seq <- seq(from=0, to=5, by=0.1)
mu_link <- function(weight) post$b0 + post$b1*log(weight)
mu <- sapply(weight_seq, mu_link)
mu_mean <- apply(mu, 2, mean)
mu_hdpi <- apply(mu, 2, HPDI, prob=0.95)
height_weight <- function(weight){
rnorm(n=nrow(post), mean = post$b0 + post$b1*log(weight), sd=post$sigma)
}
sim_height <- sapply(weight_seq, height_weight)
height_hpdi <- apply(sim_height, 2, HPDI, prob=0.95)
plot(height~ weight, data=data_height_2, col=col.alpha(rangi2, 0.9))
lines(weight_seq, mu_mean)
shade(mu_hdpi, weight_seq)
shade(height_hpdi, weight_seq)
height_weight <- function(weight){
rnorm(n=nrow(post), mean = post$b0 + post$b1*weight, sd=post$sigma)
}
sim_height <- sapply(weight_seq, height_weight)
height_hpdi <- apply(sim_height, 2, HPDI, prob=0.95)
plot(height~ weight, data=data_height_2, col=col.alpha(rangi2, 0.9))
lines(weight_seq, mu_mean)
shade(mu_hdpi, weight_seq)
shade(height_hpdi, weight_seq)
plot(height~ weight, data=data_height_2, col=col.alpha(rangi2, 0.9))
lines(weight_seq, mu_mean)
shade(mu_hdpi, weight_seq)
shade(height_hpdi, weight_seq)
weight_seq <- seq(from=0, to=5, by=0.1)
mu_link <- function(weight) post$b0 + post$b1*weight
mu <- sapply(weight_seq, mu_link)
mu_mean <- apply(mu, 2, mean)
mu_hdpi <- apply(mu, 2, HPDI, prob=0.95)
height_weight <- function(weight){
rnorm(n=nrow(post), mean = post$b0 + post$b1*weight, sd=post$sigma)
}
sim_height <- sapply(weight_seq, height_weight)
height_hpdi <- apply(sim_height, 2, HPDI, prob=0.95)
plot(height~ weight, data=data_height_2, col=col.alpha(rangi2, 0.9))
lines(weight_seq, mu_mean)
shade(mu_hdpi, weight_seq)
shade(height_hpdi, weight_seq)
weight_seq <- seq(from=0, to=5, by=0.1)
mu_link <- function(weight) post$b0 + post$b1*weight
mu <- sapply(weight_seq, mu_link)
mu_mean <- apply(mu, 2, mean)
mu
head(mu)
head(mu_mean)
weight_seq
mu_mean
data_height_2 <- data_height
data_height_2$weight<- log(data_height_2$weight)
heigth_reg_log <- quap(
alist(
height ~ dnorm( b0 + b1*weight, sigma ),
b0 ~ dnorm(60, 50) ,
b1 ~ dnorm( 0 , 1),
sigma ~ dunif( 0 , 50)
) , data=data_height_2)
precis(heigth_reg_log, prob=0.95)
data_height_2 <- data_height
data_height_2$weight<- log(data_height_2$weight)
heigth_reg_log <- quap(
alist(
height ~ dnorm( b0 + b1*weight, sigma ),
b0 ~ dnorm(60, 50) ,
b1 ~ dnorm( 0 , 1),
sigma ~ dunif( 0 , 50)
) , data=data_height_2)
precis(heigth_reg_log, prob=0.95)
summary(lm(height ~ weight, data = data_height_2))
data_height_2 <- data_height
data_height_2$weight<- log(data_height_2$weight)
heigth_reg_log <- quap(
alist(
height ~ dnorm( b0 + b1*weight, sigma ),
b0 ~ dnorm(60, 50) ,
b1 ~ dnorm( 0 , 1),
sigma ~ dunif( 0 , 50)
) , data=data_height_2)
precis(heigth_reg_log, prob=0.95)
summary(lm(height ~ weight, data = data_height_2))
data_height_2 <- data_height
data_height_2$weight<- log(data_height_2$weight)
heigth_reg_log <- quap(
alist(
height ~ dnorm( b0 + b1*weight, sigma ),
b0 ~ dnorm(60, 50) ,
b1 ~ dnorm( 0 , 1),
sigma ~ dunif( 0 , 50)
) , data=data_height_2)
head(data_height_2)
data_height_2 <- data_height
data_height_2$weight<- log(data_height_2$weight)
heigth_reg_log <- quap(
alist(
height ~ dnorm( b0 + b1*weight, sigma ),
b0 ~ dnorm(60, 50) ,
b1 ~ dnorm( 0 , 1),
sigma ~ dunif( 0 , 50)
) , data=data_height_2)
precis(heigth_reg_log, prob=0.95)
data_height_2 <- data_height
data_height_2$weight<- log(data_height_2$weight)
heigth_reg_log <- quap(
alist(
height ~ dnorm( b0 + b1*weight, sigma ),
b0 ~ dnorm(60, 50) ,
b1 ~ dlnorm( 0 , 1),
sigma ~ dunif( 0 , 50)
) , data=data_height_2)
precis(heigth_reg_log, prob=0.95)
summary(lm(height ~ weight, data = data_height_2))
post <- extract.samples(heigth_reg_log, n=1e4)
weight_seq <- seq(from=0, to=5, by=0.1)
mu_link <- function(weight) post$b0 + post$b1*weight
mu <- sapply(weight_seq, mu_link)
mu_mean <- apply(mu, 2, mean)
weight_seq <- seq(from=0, to=5, by=0.1)
mu_link <- function(weight) post$b0 + post$b1*weight
mu <- sapply(weight_seq, mu_link)
mu_mean <- apply(mu, 2, mean)
mu_hdpi <- apply(mu, 2, HPDI, prob=0.95)
height_weight <- function(weight){
rnorm(n=nrow(post), mean = post$b0 + post$b1*weight, sd=post$sigma)
}
sim_height <- sapply(weight_seq, height_weight)
height_hpdi <- apply(sim_height, 2, HPDI, prob=0.95)
plot(height~ weight, data=data_height_2, col=col.alpha(rangi2, 0.9))
lines(weight_seq, mu_mean)
shade(mu_hdpi, weight_seq)
shade(height_hpdi, weight_seq)
data_height_2 <- data_height
data_height_2$weight<- log(data_height_2$weight)
heigth_reg_log <- quap(
alist(
height ~ dnorm( b0 + b1*weight, sigma ),
b0 ~ dnorm(60, 50) ,
b1 ~ dlnorm( 0 , 1),
sigma ~ dunif( 0 , 50)
) , data=data_height_2)
precis(heigth_reg_log, prob=0.95)
summary(lm(height ~ weight, data = data_height_2))
post <- extract.samples(heigth_reg_log, n=1e4)
weight_seq <- seq(from=0, to=5, by=0.1)
mu_link <- function(weight) post$b0 + post$b1*weight
mu <- sapply(weight_seq, mu_link)
mu_mean <- apply(mu, 2, mean)
mu_hdpi <- apply(mu, 2, HPDI, prob=0.95)
height_weight <- function(weight){
rnorm(n=nrow(post), mean = post$b0 + post$b1*weight, sd=post$sigma)
}
sim_height <- sapply(weight_seq, height_weight)
height_hpdi <- apply(sim_height, 2, HPDI, prob=0.95)
plot(height~ weight, data=data_height_2, col=col.alpha(rangi2, 0.9))
lines(weight_seq, mu_mean)
shade(mu_hdpi, weight_seq)
shade(height_hpdi, weight_seq)
# Manipulación de estructuras
library(tidyverse)
library(dplyr)
library(tidyr)
# Para realizar plots
library(scatterplot3d)
library(ggplot2)
library(plotly)
# Manipulación de varios plots en una imagen.
library(gridExtra)
# Análisis bayesiano
library("rethinking")
options(warn = -1)
